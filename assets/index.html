<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buchloe Veranstaltungskalender</title>
  
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Tailwind Config for shadcn/ui-like styling -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            border: "hsl(214.3 31.8% 91.4%)",
            input: "hsl(214.3 31.8% 91.4%)",
            ring: "hsl(222.2 84% 4.9%)",
            background: "hsl(0 0% 100%)",
            foreground: "hsl(222.2 84% 4.9%)",
            primary: {
              DEFAULT: "hsl(222.2 47.4% 11.2%)",
              foreground: "hsl(210 40% 98%)",
            },
            secondary: {
              DEFAULT: "hsl(210 40% 96%)",
              foreground: "hsl(222.2 84% 4.9%)",
            },
            destructive: {
              DEFAULT: "hsl(0 84.2% 60.2%)",
              foreground: "hsl(210 40% 98%)",
            },
            muted: {
              DEFAULT: "hsl(210 40% 96%)",
              foreground: "hsl(215.4 16.3% 46.9%)",
            },
            accent: {
              DEFAULT: "hsl(210 40% 96%)",
              foreground: "hsl(222.2 84% 4.9%)",
            },
            popover: {
              DEFAULT: "hsl(0 0% 100%)",
              foreground: "hsl(222.2 84% 4.9%)",
            },
            card: {
              DEFAULT: "hsl(0 0% 100%)",
              foreground: "hsl(222.2 84% 4.9%)",
            },
          },
          borderRadius: {
            lg: "var(--radius)",
            md: "calc(var(--radius) - 2px)",
            sm: "calc(var(--radius) - 4px)",
          },
          animation: {
            "fade-in": "fadeIn 0.5s ease-in-out",
            "slide-in": "slideIn 0.3s ease-out",
          },
          keyframes: {
            fadeIn: {
              "0%": { opacity: "0", transform: "translateY(10px)" },
              "100%": { opacity: "1", transform: "translateY(0)" },
            },
            slideIn: {
              "0%": { transform: "translateX(-10px)", opacity: "0" },
              "100%": { transform: "translateX(0)", opacity: "1" },
            },
          },
        },
      },
    }
  </script>
  
  <style>
    :root {
      --radius: 0.5rem;
    }
    
    /* Custom animations for button states */
    .copy-button-success {
      background-color: hsl(142.1 76.2% 36.3%) !important;
      transform: scale(1.05);
      transition: all 0.2s ease-in-out;
    }
    
    .copy-button-error {
      background-color: hsl(0 84.2% 60.2%) !important;
      transform: scale(1.05);
      transition: all 0.2s ease-in-out;
    }
    
    /* Smooth transitions for all interactive elements */
    .transition-all {
      transition: all 0.2s ease-in-out;
    }
    
    /* Focus styles for accessibility */
    .focus-ring:focus {
      outline: 2px solid hsl(222.2 84% 4.9%);
      outline-offset: 2px;
    }
  </style>
</head>

<body class="bg-background text-foreground min-h-screen">
  <div class="container mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8">
    
    <!-- Header -->
    <header class="text-center mb-8 animate-fade-in">
      <h1 class="text-4xl font-bold text-primary mb-4 sm:text-5xl">
        üóìÔ∏è Buchloe Veranstaltungskalender
      </h1>
      <p class="text-lg text-muted-foreground max-w-2xl mx-auto">
        Willkommen zum automatisch generierten Veranstaltungskalender f√ºr Buchloe!
      </p>
    </header>

    <!-- Quick Start Card -->
    <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-8 shadow-sm animate-slide-in">
      <div class="flex items-start space-x-3">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
            <span class="text-green-600 text-lg">üéØ</span>
          </div>
        </div>
        <div class="flex-1">
          <h2 class="text-xl font-semibold text-green-800 mb-3">Schnellstart: Kalender abonnieren</h2>
          <p class="text-green-700 font-medium mb-4">Empfohlene Methode f√ºr automatische Updates:</p>
          <ol class="text-green-700 space-y-2 text-lg">
            <li class="flex items-center space-x-2">
              <span class="w-7 h-7 bg-green-200 rounded-full flex items-center justify-center text-sm font-medium flex-shrink-0">1</span>
              <span>Kopieren Sie die URL unten üëá</span>
            </li>
            <li class="flex items-center space-x-2">
              <span class="w-7 h-7 bg-green-200 rounded-full flex items-center justify-center text-sm font-medium flex-shrink-0">2</span>
              <span>F√ºgen Sie sie als Kalender-Abonnement in Ihrer Kalender-App hinzu</span>
            </li>
            <li class="flex items-center space-x-2">
              <span class="w-7 h-7 bg-green-200 rounded-full flex items-center justify-center text-sm font-medium flex-shrink-0">3</span>
              <span>Fertig! Sie erhalten automatisch alle neuen Veranstaltungen üéâ</span>
            </li>
          </ol>
        </div>
      </div>
    </div>

    <!-- Calendar Subscription Card -->
    <div class="bg-card border border-border rounded-lg shadow-sm mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-semibold text-card-foreground mb-4 flex items-center space-x-2">
          <span>üìÖ</span>
          <span>Kalender abonnieren (empfohlen)</span>
        </h2>
        
        <!-- Success Alert -->
        <div class="bg-green-50 border border-green-200 rounded-md p-4 mb-4">
          <div class="flex items-start space-x-3">
            <span class="text-green-600 text-lg">‚úÖ</span>
            <div>
              <p class="font-medium text-green-800 mb-2">So erhalten Sie automatische Updates:</p>
              <p class="text-green-700 mb-4">Kopieren Sie diese URL und f√ºgen Sie sie als Kalender-Abonnement in Ihrer Kalender-App hinzu:</p>
              
              <!-- URL Container -->
              <div class="flex flex-col sm:flex-row gap-3 items-start">
                <div class="flex-1 min-w-0">
                  <div id="calendar-url" class="bg-muted border border-input rounded-md px-3 py-2 text-sm font-mono break-all text-muted-foreground"></div>
                </div>
                <button 
                  onclick="copyToClipboard()" 
                  class="copy-button bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-all focus-ring flex items-center space-x-2 whitespace-nowrap"
                >
                  <span>üìã</span>
                  <span>Kopieren</span>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Warning Alert -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-md p-4">
          <div class="flex items-start space-x-3">
            <span class="text-yellow-600 text-lg">‚ö†Ô∏è</span>
            <div>
              <p class="font-medium text-yellow-800 mb-1">Wichtig:</p>
              <p class="text-yellow-700">Verwenden Sie die URL oben f√ºr ein Abonnement, nicht den direkten Download. Nur so erhalten Sie automatische Updates alle 6 Stunden!</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Setup Instructions Card -->
    <div class="bg-card border border-border rounded-lg shadow-sm mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-semibold text-card-foreground mb-4 flex items-center space-x-2">
          <span>üì±</span>
          <span>So richten Sie das Kalender-Abonnement ein</span>
        </h2>
        <p class="text-muted-foreground mb-6 font-medium">Schritt-f√ºr-Schritt Anleitung:</p>
        
        <div class="grid gap-6 md:grid-cols-2">
          <!-- Google Calendar Mobile -->
          <div class="bg-secondary rounded-lg p-4">
            <h3 class="font-semibold text-secondary-foreground mb-3 flex items-center space-x-2">
              <span>üì±</span>
              <span>Google Calendar (Handy-App)</span>
            </h3>
            <ol class="text-sm text-secondary-foreground space-y-2">
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">1</span>
                <span>√ñffnen Sie die Google Calendar App</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">2</span>
                <span>Tippen Sie auf das ‚ò∞ Men√º (drei Striche)</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">3</span>
                <span>W√§hlen Sie "Einstellungen"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">4</span>
                <span>Tippen Sie auf "Kalender hinzuf√ºgen" ‚Üí "√úber URL"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">5</span>
                <span>F√ºgen Sie die obige URL ein und best√§tigen Sie</span>
              </li>
            </ol>
          </div>

          <!-- Google Calendar Web -->
          <div class="bg-secondary rounded-lg p-4">
            <h3 class="font-semibold text-secondary-foreground mb-3 flex items-center space-x-2">
              <span>üñ•Ô∏è</span>
              <span>Google Calendar (Web)</span>
            </h3>
            <ol class="text-sm text-secondary-foreground space-y-2">
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">1</span>
                <span>Gehen Sie zu <a href="https://calendar.google.com" target="_blank" class="text-blue-600 hover:text-blue-800 underline">calendar.google.com</a></span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">2</span>
                <span>Klicken Sie links auf das "+" neben "Weitere Kalender"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">3</span>
                <span>W√§hlen Sie "Kalender abbonieren" und dann "Per URL"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">4</span>
                <span>F√ºgen Sie die obige URL ein und klicken Sie "Kalender hinzuf√ºgen"</span>
              </li>
            </ol>
          </div>

          <!-- Apple Calendar Mobile -->
          <div class="bg-secondary rounded-lg p-4">
            <h3 class="font-semibold text-secondary-foreground mb-3 flex items-center space-x-2">
              <span>üçé</span>
              <span>Apple Calendar (iPhone/iPad)</span>
            </h3>
            <ol class="text-sm text-secondary-foreground space-y-2">
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">1</span>
                <span>√ñffnen Sie die "Kalender"-App</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">2</span>
                <span>Tippen Sie mittig am unteren Bildschirmrand auf "Kalender"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">3</span>
                <span>Tippen Sie links-unten auf "Hinzuf√ºgen"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">4</span>
                <span>W√§hlen Sie "Kalenderabonnement hinzuf√ºgen"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">5</span>
                <span>F√ºgen Sie die obige URL ein und best√§tigen Sie mit "Abbonieren"</span>
              </li>
            </ol>
          </div>

          <!-- Apple Calendar Mac -->
          <div class="bg-secondary rounded-lg p-4">
            <h3 class="font-semibold text-secondary-foreground mb-3 flex items-center space-x-2">
              <span>üñ•Ô∏è</span>
              <span>Apple Calendar (Mac)</span>
            </h3>
            <ol class="text-sm text-secondary-foreground space-y-2">
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">1</span>
                <span>√ñffnen Sie die Kalender-App</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">2</span>
                <span>Gehen Sie zu "Datei" ‚Üí "Neues Kalender-Abonnement"</span>
              </li>
              <li class="flex items-start space-x-2">
                <span class="w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium mt-0.5 flex-shrink-0">3</span>
                <span>F√ºgen Sie die obige URL ein und klicken Sie "Abonnieren"</span>
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <!-- Information Card -->
    <div class="bg-card border border-border rounded-lg shadow-sm mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-semibold text-card-foreground mb-4 flex items-center space-x-2">
          <span>‚ÑπÔ∏è</span>
          <span>Informationen</span>
        </h2>
        <ul class="space-y-3 text-muted-foreground">
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Der Kalender wird automatisch alle 6 Stunden aktualisiert</span>
          </li>
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Datenquelle: <a href="https://www.buchloe.de/freizeit-tourismus/veranstaltungen/" target="_blank" class="text-blue-600 hover:text-blue-800 underline">Buchloe Veranstaltungen</a></span>
          </li>
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Letztes Update: <span class="font-mono text-sm" id="last-update">Wird geladen...</span></span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Technical Details Card -->
    <div class="bg-card border border-border rounded-lg shadow-sm mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-semibold text-card-foreground mb-4 flex items-center space-x-2">
          <span>üîß</span>
          <span>Technische Details</span>
        </h2>
        <ul class="space-y-3 text-muted-foreground">
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Automatisierte Datenerfassung mit Python</span>
          </li>
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>iCal-Format (RFC 5545) kompatibel</span>
          </li>
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Bereitstellung √ºber GitHub Pages</span>
          </li>
          <li class="flex items-start space-x-3">
            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
            <span>Open Source: <a href="https://github.com/croesnick/buchloe-veranstaltungskalender" target="_blank" class="text-blue-600 hover:text-blue-800 underline">GitHub Repository</a></span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-border pt-6 mt-8">
      <p class="text-center text-muted-foreground">
        Automatisch generiert mit ‚ù§Ô∏è f√ºr Buchloe
      </p>
    </footer>
  </div>

  <script>
    const calendarUrl = window.location.origin + window.location.pathname + 'events.ics';
    document.getElementById('calendar-url').textContent = calendarUrl;

    // Set last update timestamp from info.json
    async function loadLastUpdateTimestamp() {
      try {
        const response = await fetch('info.json');
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}`);
        }
        const info = await response.json();
        
        // Parse the UTC timestamp and convert to German locale
        const utcDate = new Date(info.last_updated + ' UTC');
        const germanTime = utcDate.toLocaleString('de-DE', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          timeZone: 'Europe/Berlin'
        });
        
        document.getElementById('last-update').textContent = germanTime;
      } catch (error) {
        console.error('Failed to load timestamp from info.json:', error);
        document.getElementById('last-update').textContent = 'Unbekannt';
      }
    }
    
    // Load the timestamp when page loads
    loadLastUpdateTimestamp();

    function copyToClipboard() {
      const urlText = document.getElementById('calendar-url').textContent;

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(urlText)
          .then(() => showCopySuccess())
          .catch(() => fallbackCopyToClipboard(urlText));
      } else {
        fallbackCopyToClipboard(urlText);
      }
    }

    function showCopySuccess() {
      const button = document.querySelector('.copy-button');
      const originalText = button.innerHTML;
      button.innerHTML = '<span>‚úÖ</span><span>Kopiert!</span>';
      button.classList.add('copy-button-success');

      setTimeout(() => {
        button.innerHTML = originalText;
        button.classList.remove('copy-button-success');
      }, 2000);
    }

    function fallbackCopyToClipboard(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.left = '-9999px';
      textArea.style.top = '-9999px';
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();

      try {
        document.execCommand('copy');
        showCopySuccess();
      } catch (err) {
        console.error('Fallback: Failed to copy text', err);
        showCopyError();
      }

      document.body.removeChild(textArea);
    }

    function showCopyError() {
      const button = document.querySelector('.copy-button');
      const originalText = button.innerHTML;
      button.innerHTML = '<span>‚ùå</span><span>Fehler</span>';
      button.classList.add('copy-button-error');

      setTimeout(() => {
        button.innerHTML = originalText;
        button.classList.remove('copy-button-error');
      }, 2000);
    }
  </script>
</body>

</html>